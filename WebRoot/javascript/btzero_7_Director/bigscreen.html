<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>大屏监控</title>
<meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no'
	name='viewport'>
<meta name="description" content="Developed By M Abdur Rokib Promy">
<meta name="keywords" content="Admin, Bootstrap 3, Template, Theme, Responsive">
<link type="text/css" rel="stylesheet" href="../../styles/TimeCircles.css" />
<!-- bootstrap 3.0.2 -->
<link href="./css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<!-- font Awesome -->
<link href="./css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<!-- Ionicons -->
<link href="./css/ionicons.min.css" rel="stylesheet" type="text/css" />
<!-- Morris chart -->
<link href="./css/morris/morris.css" rel="stylesheet" type="text/css" />
<!-- jvectormap -->
<link href="./css/jvectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css" />
<!-- Date Picker -->
<link href="./css/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />
<!-- fullCalendar -->
<!-- <link href="css/fullcalendar/fullcalendar.css" rel="stylesheet" type="text/css" /> -->
<!-- Daterange picker -->
<link href="./css/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css" />
<!-- iCheck for checkboxes and radio inputs -->
<link href="./css/iCheck/all.css" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
<!-- Theme style -->
<link title="default" href="./css/style_black.css" rel="stylesheet" type="text/css" />
<link title="white" rel="stylesheet" type="text/css" href="./css/style.css" disabled="disabled"/>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
          <![endif]-->

<style type="text/css">
.sm-st{
	margin-bottom:5px;
	/* min-height:100px; */
	padding:20px 10px;
}
.sm-st-icon{
	width: 90px;
    height: 90px;
    display: inline-block;
    line-height: 90px;
    text-align: center;
    font-size: 40px;
   
}
.sm-st-info .name{
	font-weight:bold;
	font-size:18px;
}
body > .header .logo{
	text-align:left;
}
</style>
</head>
<body class="skin-black">
	<!-- header logo: style can be found in header.less -->
	<header class="header">
		<a href="bigscreen.html" id="index_label" class="logo">
			<span style="float:left; font-size: 28px;"><i class="fa fa-home"></i> <span class="label" style="padding:1px;">实时监控</span></span>
			<span id="systemtime" style="font-size:14px;font-weight:bold;float:left;padding-left:15px;padding-top:3px;"></span>
		</a>
		<!-- Header Navbar: style can be found in header.less -->
		<nav class="navbar navbar-static-top" role="navigation">
			<!-- Sidebar toggle button-->
			<div class="navbar-right">
				<ul class="nav navbar-nav">
					<!-- Messages: style can be found in dropdown.less-->
					<li class="dropdown messages-menu timer">
						<div id="netDataCountDownTimer" title="本次监控时长(刷新频率：一分钟)"></div>
					</li>
					<li class="dropdown messages-menu">
						<span id="systemtime"></span>
					</li>
				
					<li class="dropdown messages-menu">
						<a href="#" class="dropdown-toggle" onclick="launchFullscreen(document.documentElement);"> 
							<i class="fa fa-tasks"></i> <span class="label label-success">开</span>
						</a>
					</li>
					<li class="dropdown tasks-menu">
						<a href="#" class="dropdown-toggle" onclick="exitFullscreen();">
							<i class="fa fa-tasks"></i> <span class="label label-danger">关</span>
						</a>
					</li>
					<!-- <li class="dropdown tasks-menu">
						<ul id="mythems">
					         <li id="default">经典</li>
					         <li id="white">白色</li>
					     </ul>
					</li> -->
				</ul>
			</div>
		</nav>
	</header>
	<div class="wrapper row-offcanvas row-offcanvas-left">
		<aside class="left-side sidebar-offcanvas">
		</aside>
		<aside class="right-side" id="rightContent">
		</aside>
	</div>
	<!-- ./wrapper -->


	<!-- jQuery 2.0.2 -->
	<script src="js/jquery.min.js" type="text/javascript"></script>
		<!-- <script src="js/jquery.cookie.js" type="text/javascript"></script> -->
	<script src="js/jquery.jclock.js" type="text/javascript"></script>

	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js" type="text/javascript"></script>
	<!-- daterangepicker -->
	<script src="js/plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>

	<script src="js/plugins/chart.js" type="text/javascript"></script>
	<!-- iCheck -->
	<script src="js/plugins/iCheck/icheck.min.js" type="text/javascript"></script>
	<!-- calendar -->
	<script src="js/plugins/fullcalendar/fullcalendar.js" type="text/javascript"></script>

	<!-- Director App -->
	<script src="js/Director/app.js" type="text/javascript"></script>
	<script src="js/util.js" type="text/javascript"></script>
	<script type="text/javascript" src="../../javascript/jquery-easyui-1.4.4/TimeCircles.js"></script>

	<script type="text/javascript">
		
		//默认左侧导航栏折叠
	 	$('.left-side').toggleClass("collapse-left");
        $(".right-side").toggleClass("strech");
        
		$('input').on('ifChecked', function(event) {
			$(this).parents('li').addClass("task-done");
			console.log('ok');
		});
		$('input').on('ifUnchecked', function(event) {
			$(this).parents('li').removeClass("task-done");
			console.log('not');
		});
		//当前时间
 		$('#systemtime').jclock({withDate:true, withWeek:true});


	</script>
	<script>
		$('input[type="checkbox"].flat-grey, input[type="radio"].flat-grey')
				.iCheck({
					checkboxClass : 'icheckbox_flat-grey',
					radioClass : 'iradio_flat-grey'
				});
	</script>
	<script type="text/javascript">
		var userCode = "";
		function launchFullscreen(element) {
		  if(element.requestFullscreen) {
		    element.requestFullscreen();
		  } else if(element.mozRequestFullScreen) {
		    element.mozRequestFullScreen();
		  } else if(element.webkitRequestFullscreen) {
		    element.webkitRequestFullscreen();
		  } else if(element.msRequestFullscreen) {
		    element.msRequestFullscreen();
		  }
		}
		
		function exitFullscreen() {
			if (document.exitFullscreen) { 
			document.exitFullscreen(); 
			} 
			else if (document.mozCancelFullScreen) { 
			document.mozCancelFullScreen(); 
			} 
			else if (document.webkitCancelFullScreen) { 
			document.webkitCancelFullScreen(); 
			} 
			else if (document.msExitFullscreen) { 
			document.msExitFullscreen(); 
			}
		}
		
		//定时器
		if($("#netDataCountDownTimer").TimeCircles() != null){
			$("#netDataCountDownTimer").TimeCircles().destroy();
		}
		$("#netDataCountDownTimer").TimeCircles();
		$("#netDataCountDownTimer").TimeCircles({count_past_zero: true}).addListener(countdownComplete);
		function countdownComplete(unit, value, total){
			if(unit=='Seconds' && value==0){
				refreshData();
			}
		}
		function refreshData(){
			var htmlArr = []; 
				$.ajax({
						url : "../../GeneralMonitorController/getGenaralAreaData",
						type : "post",
						dataType : "json",
						data:{'select':userCode},
						async : false,
						success : function(json) {
							if(json!=null && json!={} && json.select!=null){
								userCode = json.select;
							}
							if(json.result){
								$("#rightContent").html("");
								for(var i=0;i<json.rows.length;i++){
									var devicelist = json.rows[i].gadmList;
									if(json.rows.length == 1){
										htmlArr.push('<section class="clearfix panel col-md-12 col-sm-12 " style="margin-bottom:1px;min-height:192px;">');
									}else{
										htmlArr.push('<section class="clearfix panel col-md-6 col-sm-12 " style="margin-bottom:1px;min-height:192px;">');
									}
									htmlArr.push('<header class="panel-heading" style="background:#4e4e59;">'+json.rows[i].areaName+'</header>');
									htmlArr.push('<div class="row" style="margin-bottom:5px;margin-top:5px;">');
					
									for(var j=0;j<devicelist.length;j++){
										if(json.rows.length == 1){
											htmlArr.push('<div class="col-md-4" style="margin-top:2px;">');
										}else{
											htmlArr.push('<div class="col-md-6" style="margin-top:2px;">');
										}
										htmlArr.push('<div class="sm-st clearfix">');
										var icon = getStatusIcon(devicelist[j].statusCode);
										htmlArr.push(icon);
										htmlArr.push('<div class="sm-st-info"><div class="name">'+devicelist[j].deviceName+'</div><div>'+devicelist[j].statusName+'</div>');
										var monitorlist = devicelist[j].gadtmList;
										for(var z=0;z<monitorlist.length;z++){
												if(monitorlist[z].thingCode=='a01008'){
												var wdValue = monitorlist[z].thingValue;
												//风向显示备注
							 					if(wdValue != undefined && wdValue != null){
							 						if(wdValue == 0){
							 	 						wdValue += "-正北风";
							 						}else if(wdValue == 90){
							 							wdValue += "-正东风";
							 						}else if(wdValue == 180){
							 							wdValue += "-正南风";
							 						}else if(wdValue == 270){
							 							wdValue += "-正西风";
							 						}else if(wdValue>0 && wdValue<90){
							 							wdValue += "-东北风";
							 						}else if(wdValue>90 && wdValue<180){
							 							wdValue += "-东南风";
							 						}else if(wdValue>180 && wdValue<270){
							 							wdValue += "-西南风";
							 						}else if(wdValue>270 && wdValue<360){
							 							wdValue += "-西北风";
							 						}else{
							 							wdValue += "-未知风向";
							 						}
						 						}
												htmlArr.push('<div><label>'+monitorlist[z].thingName+'</label>：<label style="font-size:18px;font-weight:bold;">'+wdValue+'</label></div>');
											}else{
												htmlArr.push('<div><label>'+monitorlist[z].thingName+'</label>：<label style="font-size:18px;font-weight:bold;">'+monitorlist[z].thingValue+'</label><label>&nbsp;  '+monitorlist[z].thingUnit+'</label></div>');
											}
											htmlArr.push('<div>'+monitorlist[z].updateTime+'</div>');
										}
										htmlArr.push('</div>');
										htmlArr.push('</div>');
										htmlArr.push('</div>');
									}
								htmlArr.push('</div>');
								htmlArr.push('</section>');
								}
								$("#rightContent").append(htmlArr.join(""));
							}else{
								if($("#netDataCountDownTimer").TimeCircles() != null){
									$("#netDataCountDownTimer").TimeCircles().destroy();
								}
								confirm(json.detail);
							}
						}
				});
		}
		refreshData();
	</script>
</body>
</html>